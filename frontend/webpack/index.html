<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack | 学习笔记</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/docs/favicon.ico">
    <link rel="manifest" href="/docs/manifest.json">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="前端工程师 Alex 的学习笔记">
    <meta name="author" content="Alex Wang">
    <meta name="keywords" content="vuepress , 前端, 学习笔记">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/docs/assets/css/0.styles.d2cb8686.css" as="style"><link rel="preload" href="/docs/assets/js/app.84b26931.js" as="script"><link rel="preload" href="/docs/assets/js/2.ce1bac44.js" as="script"><link rel="preload" href="/docs/assets/js/3.de591152.js" as="script"><link rel="preload" href="/docs/assets/js/7.f3e6aa45.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.9e342d30.js"><link rel="prefetch" href="/docs/assets/js/11.f40a53da.js"><link rel="prefetch" href="/docs/assets/js/12.16498b95.js"><link rel="prefetch" href="/docs/assets/js/13.b3f6806f.js"><link rel="prefetch" href="/docs/assets/js/14.cdfce6cd.js"><link rel="prefetch" href="/docs/assets/js/15.56907925.js"><link rel="prefetch" href="/docs/assets/js/16.4ddad054.js"><link rel="prefetch" href="/docs/assets/js/17.3540b6fb.js"><link rel="prefetch" href="/docs/assets/js/18.79300792.js"><link rel="prefetch" href="/docs/assets/js/19.03ad5bb0.js"><link rel="prefetch" href="/docs/assets/js/20.ded21212.js"><link rel="prefetch" href="/docs/assets/js/21.e657d943.js"><link rel="prefetch" href="/docs/assets/js/22.a7839767.js"><link rel="prefetch" href="/docs/assets/js/23.a8f18f0b.js"><link rel="prefetch" href="/docs/assets/js/24.c9254768.js"><link rel="prefetch" href="/docs/assets/js/25.d08eb9b8.js"><link rel="prefetch" href="/docs/assets/js/26.16666ea5.js"><link rel="prefetch" href="/docs/assets/js/27.5acfebc6.js"><link rel="prefetch" href="/docs/assets/js/28.ebe9596b.js"><link rel="prefetch" href="/docs/assets/js/29.47fa60b8.js"><link rel="prefetch" href="/docs/assets/js/30.3d29431d.js"><link rel="prefetch" href="/docs/assets/js/31.1eabdbb0.js"><link rel="prefetch" href="/docs/assets/js/32.9005245e.js"><link rel="prefetch" href="/docs/assets/js/33.b62a5685.js"><link rel="prefetch" href="/docs/assets/js/34.8c2c84ea.js"><link rel="prefetch" href="/docs/assets/js/35.9336b5cb.js"><link rel="prefetch" href="/docs/assets/js/36.97a3cc76.js"><link rel="prefetch" href="/docs/assets/js/37.66398741.js"><link rel="prefetch" href="/docs/assets/js/38.9d8de1d8.js"><link rel="prefetch" href="/docs/assets/js/39.8f67c036.js"><link rel="prefetch" href="/docs/assets/js/4.f5f9c22c.js"><link rel="prefetch" href="/docs/assets/js/40.e98a9424.js"><link rel="prefetch" href="/docs/assets/js/41.226b689f.js"><link rel="prefetch" href="/docs/assets/js/42.6d8e3c92.js"><link rel="prefetch" href="/docs/assets/js/43.b09bfbcd.js"><link rel="prefetch" href="/docs/assets/js/44.110861cb.js"><link rel="prefetch" href="/docs/assets/js/45.1361df68.js"><link rel="prefetch" href="/docs/assets/js/46.0825a84a.js"><link rel="prefetch" href="/docs/assets/js/47.7eed1a37.js"><link rel="prefetch" href="/docs/assets/js/48.314fd5a1.js"><link rel="prefetch" href="/docs/assets/js/49.09c0dc2c.js"><link rel="prefetch" href="/docs/assets/js/5.bc5eb3ee.js"><link rel="prefetch" href="/docs/assets/js/50.14490fbe.js"><link rel="prefetch" href="/docs/assets/js/51.10b8fc7a.js"><link rel="prefetch" href="/docs/assets/js/52.a3add2d1.js"><link rel="prefetch" href="/docs/assets/js/53.c4ce192c.js"><link rel="prefetch" href="/docs/assets/js/54.5cd22bdd.js"><link rel="prefetch" href="/docs/assets/js/55.9fe70fbb.js"><link rel="prefetch" href="/docs/assets/js/56.829f69ec.js"><link rel="prefetch" href="/docs/assets/js/57.97f358a1.js"><link rel="prefetch" href="/docs/assets/js/58.11cbfa72.js"><link rel="prefetch" href="/docs/assets/js/59.8200c4ed.js"><link rel="prefetch" href="/docs/assets/js/6.232177ed.js"><link rel="prefetch" href="/docs/assets/js/60.db894496.js"><link rel="prefetch" href="/docs/assets/js/61.d80fbdff.js"><link rel="prefetch" href="/docs/assets/js/62.2a66782f.js"><link rel="prefetch" href="/docs/assets/js/8.78886e18.js"><link rel="prefetch" href="/docs/assets/js/9.de6828aa.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.d2cb8686.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="backend" class="dropdown-title"><span class="title">backend</span> <span class="arrow down"></span></button> <button type="button" aria-label="backend" class="mobile-dropdown-title"><span class="title">backend</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/backend/NodeJs/" class="nav-link">
  Node Js
</a></li><li class="dropdown-item"><!----> <a href="/docs/backend/服务端渲染/" class="nav-link">
  服务端渲染
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="frontend" class="dropdown-title"><span class="title">frontend</span> <span class="arrow down"></span></button> <button type="button" aria-label="frontend" class="mobile-dropdown-title"><span class="title">frontend</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/frontend/ES6/" class="nav-link">
  E S 6
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/HTML&amp;CSS/" class="nav-link">
  HTML&amp;CSS
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/HTML5&amp;CSS3/" class="nav-link">
  HTML5&amp;CSS3
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/JavaScript/" class="nav-link">
  Java Script
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/minPrograms/" class="nav-link">
  Min Programs
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/Network/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/ng1/" class="nav-link">
  Ng1
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/TypeScript/" class="nav-link">
  Type Script
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/VUE/" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/webpack/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Webpack
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="interview" class="dropdown-title"><span class="title">interview</span> <span class="arrow down"></span></button> <button type="button" aria-label="interview" class="mobile-dropdown-title"><span class="title">interview</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/interview/base/" class="nav-link">
  Base
</a></li><li class="dropdown-item"><!----> <a href="/docs/interview/projects/" class="nav-link">
  Projects
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="reading" class="dropdown-title"><span class="title">reading</span> <span class="arrow down"></span></button> <button type="button" aria-label="reading" class="mobile-dropdown-title"><span class="title">reading</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/reading/" class="nav-link">
  Reading
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="tools" class="dropdown-title"><span class="title">tools</span> <span class="arrow down"></span></button> <button type="button" aria-label="tools" class="mobile-dropdown-title"><span class="title">tools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/tools/axios/" class="nav-link">
  Axios
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/cli/" class="nav-link">
  Cli
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/devtools/" class="nav-link">
  Devtools
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/GIT/" class="nav-link">
  GIT
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/vscode/" class="nav-link">
  Vscode
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/vuepress/" class="nav-link">
  Vuepress
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/包管理工具/" class="nav-link">
  包管理工具
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/小工具/" class="nav-link">
  小工具
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/web-wj/docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="backend" class="dropdown-title"><span class="title">backend</span> <span class="arrow down"></span></button> <button type="button" aria-label="backend" class="mobile-dropdown-title"><span class="title">backend</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/backend/NodeJs/" class="nav-link">
  Node Js
</a></li><li class="dropdown-item"><!----> <a href="/docs/backend/服务端渲染/" class="nav-link">
  服务端渲染
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="frontend" class="dropdown-title"><span class="title">frontend</span> <span class="arrow down"></span></button> <button type="button" aria-label="frontend" class="mobile-dropdown-title"><span class="title">frontend</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/frontend/ES6/" class="nav-link">
  E S 6
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/HTML&amp;CSS/" class="nav-link">
  HTML&amp;CSS
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/HTML5&amp;CSS3/" class="nav-link">
  HTML5&amp;CSS3
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/JavaScript/" class="nav-link">
  Java Script
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/minPrograms/" class="nav-link">
  Min Programs
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/Network/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/ng1/" class="nav-link">
  Ng1
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/TypeScript/" class="nav-link">
  Type Script
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/VUE/" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/webpack/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Webpack
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="interview" class="dropdown-title"><span class="title">interview</span> <span class="arrow down"></span></button> <button type="button" aria-label="interview" class="mobile-dropdown-title"><span class="title">interview</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/interview/base/" class="nav-link">
  Base
</a></li><li class="dropdown-item"><!----> <a href="/docs/interview/projects/" class="nav-link">
  Projects
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="reading" class="dropdown-title"><span class="title">reading</span> <span class="arrow down"></span></button> <button type="button" aria-label="reading" class="mobile-dropdown-title"><span class="title">reading</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/reading/" class="nav-link">
  Reading
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="tools" class="dropdown-title"><span class="title">tools</span> <span class="arrow down"></span></button> <button type="button" aria-label="tools" class="mobile-dropdown-title"><span class="title">tools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/tools/axios/" class="nav-link">
  Axios
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/cli/" class="nav-link">
  Cli
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/devtools/" class="nav-link">
  Devtools
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/GIT/" class="nav-link">
  GIT
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/vscode/" class="nav-link">
  Vscode
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/vuepress/" class="nav-link">
  Vuepress
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/包管理工具/" class="nav-link">
  包管理工具
</a></li><li class="dropdown-item"><!----> <a href="/docs/tools/小工具/" class="nav-link">
  小工具
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/web-wj/docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/frontend/webpack/" aria-current="page" class="active sidebar-link">webpack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/frontend/webpack/#如何在浏览器端实现模块化" class="sidebar-link">如何在浏览器端实现模块化？</a></li><li class="sidebar-sub-header"><a href="/docs/frontend/webpack/#编译结果分析" class="sidebar-link">编译结果分析</a></li><li class="sidebar-sub-header"><a href="/docs/frontend/webpack/#配置文件" class="sidebar-link">配置文件</a></li><li class="sidebar-sub-header"><a href="/docs/frontend/webpack/#编译过程" class="sidebar-link">编译过程</a></li><li class="sidebar-sub-header"><a href="/docs/frontend/webpack/#入口和出口" class="sidebar-link">入口和出口</a></li><li class="sidebar-sub-header"><a href="/docs/frontend/webpack/#loader" class="sidebar-link">loader</a></li><li class="sidebar-sub-header"><a href="/docs/frontend/webpack/#plugin" class="sidebar-link">plugin</a></li><li class="sidebar-sub-header"><a href="/docs/frontend/webpack/#配置细节-细枝末节" class="sidebar-link">配置细节 - 细枝末节</a></li></ul></li><li><a href="/docs/frontend/webpack/commonTools.html" class="sidebar-link">常用扩展</a></li><li><a href="/docs/frontend/webpack/css工程化.html" class="sidebar-link">css 工程化</a></li><li><a href="/docs/frontend/webpack/js兼容性.html" class="sidebar-link">js 兼容性</a></li><li><a href="/docs/frontend/webpack/性能优化-运行.html" class="sidebar-link">性能优化 - 运行</a></li><li><a href="/docs/frontend/webpack/性能优化-构建.html" class="sidebar-link">性能优化 - 构建</a></li><li><a href="/docs/frontend/webpack/性能优化-传输.html" class="sidebar-link">性能优化 - 传输</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack"><a href="#webpack" class="header-anchor">#</a> webpack</h1> <h2 id="如何在浏览器端实现模块化"><a href="#如何在浏览器端实现模块化" class="header-anchor">#</a> 如何在浏览器端实现模块化？</h2> <h3 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h3> <ul><li>效率问题：精细的模块划分带来了更多的 js 文件，更多的 js 文件带来了更多的请求，降低了页面访问效率。</li> <li>兼容性问题：浏览器只支持 es6 模块化，不支持 CommonJS(第三方模块，例如：axios)</li> <li>工具问题：浏览器不直接支持 npm 下载的第三方包</li> <li>(非业务类)工程问题......</li></ul> <blockquote><p>根本原因是在 node 端，可以本地读取文件，效率比浏览器远程传输文件高的多。在浏览器端开发时态(devtime)和运行态(runtime)的侧重点不同。</p></blockquote> <ul><li>开发时态
<ul><li>支持多模块标准 es6、CommonJS</li> <li>模块划分精细一点</li> <li>不考虑兼容性问题</li></ul></li> <li>运行时态
<ul><li>文件少一点（合并多个相同类型文件）</li> <li>体积小一点（代码别换行了，名称简写）</li> <li>代码内容乱一点（别人看不懂代码）</li> <li>执行效率问题</li></ul></li></ul> <h3 id="解决办法"><a href="#解决办法" class="header-anchor">#</a> 解决办法</h3> <ul><li>webpack 构建工具</li> <li>grunt gulp fis browserify ......</li></ul> <blockquote><p>官网：https://www.webpackjs.com/</p></blockquote> <p>基于 nodeJs ,以开发时态的一个入口文件，分析模块的依赖关系（利用模块化导入语句 ），经过一系列的过程（压缩合并），最终生成运行时态的文件。</p> <h2 id="编译结果分析"><a href="#编译结果分析" class="header-anchor">#</a> 编译结果分析</h2> <h3 id="模拟编译结果"><a href="#模拟编译结果" class="header-anchor">#</a> 模拟编译结果</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 全局变量污染</span>
<span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;./src/a.js&quot;</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// xxx;</span>
    <span class="token comment">// module.exports = 'a'</span>
    <span class="token comment">// exports.a = 'a'</span>
    <span class="token comment">// require('./b'); =&gt; require('./src/b.js')</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;./src/b.js&quot;</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// xxx;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 专门写一个函数来运行</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">modules</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 提供 require 函数, 相当于运行一个模块，并得到导出结果 moduleId 模块路径</span>
  <span class="token keyword">function</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token parameter">moduleId</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> func <span class="token operator">=</span> modules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// 构造一个 module</span>
    <span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>
      exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 运行模块</span>
    <span class="token function">fnc</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> require<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 得到模块返回结果</span>
    <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 执行入口模块</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./src/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">&quot;./src/a.js&quot;</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// xxx;</span>
    <span class="token comment">// module.exports = 'a'</span>
    <span class="token comment">// exports.a = 'a'</span>
    <span class="token comment">// require('./b'); =&gt; require('./src/b.js')</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;./src/b.js&quot;</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// xxx;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><ul><li>为什么使用 eval 函数？
<ul><li>便于定位错误信息。简易版 source map 。</li></ul></li></ul> <h2 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h2> <ul><li>webpack.config.js</li> <li>命令行中的<code>--config</code>来指定配置文件。</li> <li>通过 CommonJS 模块导出一个对象。</li></ul> <h3 id="为什么这里不能使用-es6-导出配置文件呢"><a href="#为什么这里不能使用-es6-导出配置文件呢" class="header-anchor">#</a> 为什么这里不能使用 es6 导出配置文件呢？</h3> <ul><li><p>打包的过程中，是在 node 环境下，会读取配置文件内容，会<strong>运行</strong>一次配置文件，相当于<code>const config = require('./webpack.config.js')</code>。我们自己的代码在打包过程中是不运行的，所以支持多模块。</p></li> <li><p><code>mode: &quot;development&quot; mode: &quot;production&quot;</code></p></li></ul> <h3 id="devtool-配置"><a href="#devtool-配置" class="header-anchor">#</a> devtool 配置</h3> <ul><li><p>source map</p></li> <li><p>webpack 中的 source map</p> <ul><li>希望看到源码中的错误，而不是打包后的文件中的错误。chrome 率先支持了 source map 。没有兼容性问题，因为是开发者调试用的。。。</li> <li>多一个配置文件，浏览器发现 source map ,会找这个配置文件，文件中记录了原始代码以及转化后的代码的对应关系。</li> <li>不应在生产环境使用，source map 文件比较大，不仅会导致额外的网络传输，还会暴露原始代码。要调试真实的生产环境的代码，也需要做一些规避网络传输和代码暴露的问题。</li></ul></li></ul> <h2 id="编译过程"><a href="#编译过程" class="header-anchor">#</a> 编译过程</h2> <ul><li>整个过程大致分为三个步骤：
<ul><li>初始化</li> <li>编译</li> <li>输出</li></ul></li></ul> <p><img src="data:image/png;base64,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" alt=""></p> <h3 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h3> <ul><li>此阶段，webpack 会将<strong>CLI 参数、配置文件、默认配置</strong>进行融合，形成一个最终的配置对象。</li> <li>对配置的处理过程是依托一个第三方库 yargs 完成的。</li> <li>此阶段相对比较简单，主要是为接下来的编译阶段做必要的准备。</li> <li>目前，可以简单的理解为，初始化阶段主要用于产生一个最终的配置。</li></ul> <h3 id="编译"><a href="#编译" class="header-anchor">#</a> 编译</h3> <h4 id="_1-创建chunk"><a href="#_1-创建chunk" class="header-anchor">#</a> 1.创建chunk</h4> <ul><li><p>chunk 是 webpack 在内部构建过程中的一个概念，译为块，它表示通过某个入口找到的所有依赖的统称。</p></li> <li><p>根据入口模块（默认为./src/index.js）创建一个 chunk 。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArMAAAIJCAIAAAA51CJfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAACQnSURBVHhe7d0JlFxlmTfw6k7SSbqTdLohbB7AbAqOEAybsgl4hBjGGTBHUGYUZgQPy+cooMBBVPRDB5hxm/mGRXCO6KcQv2HEBQx4BhDUMREiiCAakgiMSBYSsnW2Tvp7OvdNvZXupLN1d7q6f79Tp3yfe29V3ds5+PzvUrdq2traSgAAm9Sm/wUAkAwAgEqSAQCQSQYAQCYZAACZZAAAZJIBAJBJBgBAJhkAAJlkAABkkgEAkEkGAEAmGQAAmWQAAGSSAQCQSQYAQCYZAACZZAAAZJIBAJBJBgBAJhkAAJlkAABkkgEAkEkGAEAmGQAAmWQAAGSSAQCQSQYAQCYZAACZZAAAZJIBAJBJBgBAJhkAAJlkAABkkgEAkEkGAEAmGQAAmWQAAGSSAQCQSQYAQCYZAACZZAAAZJIBAJBJBgBAJhkAAJlkAP3Wz372s5qamilTpqS6D7jppptileI51X1PrF5IBQxIkgEAkEkG0G+dcMIJbW1tM2bMSDXADpAMAIBMMgAAMskAAMgkA+gpU6ZMKV/lfvfddx999NHFde/Nzc2XXHLJvHnzilmhcu6ECRM6zO0gFn7f+94Xb1K5/FNPPZVmV9jWdxPKE1999dXbbrutcsXineNVxWI7K1as2ORCvO1NN90UH5FmdxLrHGse67/d5Yu33daK9dpmxtrGy+N9utgo6A/agJ5x+umnx39iixcvvvjii2Nw1FFHXXPNNeecc05TU1OU8fzkk0/G3JgeZSx84403Vs6dO3dueqMKxVsVy8e7RTl+/Phiyn333ZcW2uyxxx4rlkz1ZsXE8kcXK1b5VnfddVdadMeU3ypWOzahw4bEZqbl2tpiVkyM5/iIyuWLv1WI94l3S0tvVsyNzUn1lrp3M4tZqahQ/kfsvHrQz0gG0FOKfhbP0f8qu1q5V0VTjF7VoXeW50YrSpM2K7pp5+ZUtNt4nw7Tu2iZIT493qryo0OsT8zq/FZdK7Y0VrjDq4puWrkCxarGR8dzjNPUTWJNip7dYXoo3n8XkkHY2c0sXpWKzcQCBhTJAHpK0c9C55YWjaqYFTrPnTt3bjEr1ZtFy4ze2fnYQCh6aodZXbfMDomkrMglt956a6q3p5xXUl0h+mjMinUrN9QiGYTozcWUSrH+MStWLNWb7U4y2NnNLF6Vik3EAgYa1xlAz4qOcsIJJ6Ris0mTJhW9PPZoO88dN25cMbfDufArr7zy+eefnzp1aqorFHvhv/3tb4tyR0TDi9VIRYX3vve98bzVCxe26t57743nK664oigr7bXXXvH/MrHOMUiTNrv88svTqEKxaUuXLu3iMoudtZubeckll9xyyy3x550xY0bnrYB+STKAnlV0oM4mTJgQz5MnTy7KDoq5O66xsTGNdti73vWuNNrScccdF8873punT58ez+985zuLckfE/v22umxxeODll18uyt23O5tZxILIFnfffbdYwMAhGUDPKjrQtnQ9d2c99NBDabQDDj300DTaDeWr9HeqcR555JFp1PN2eTPLRwtuvvnmNAkGBskAqsz9998fTavy+4HhqquuSrN3WLfsBP/ud79Lo52xC0c4dtmubWYRC2Lw4IMPduOpDagKkgFUjaeeemrChAlnnHFG0bSuueaaGzcrDsLTXYqTCPGHXbp0aXENBwwckgFUh1dfffWUU06ZO3dutKvFixfPmDHj85///JWbnXrqqWm53nXAAQekUf8Sqevmm2+OP2xErscff/ySSy5JM2AAkAygOvzHf/xH7L9Go4p21Xeuhhs3blwx2IO3Bfyf//mfNOo+kbqKwbe//e2mpqZbbrnl7rvvLqZAvycZQHVYtmxZPG/r2MAf//jHNOp1xYmMn/zkJ0XZwYQJE6ZMmdItueGZZ55Joy0VX5vsIRHCfvCDH8Tgkm3cghr6H8kAqkmRDzqIjlVcebBHnH/++fH8xS9+sSgr/exnP5s7d+5W72ewU84666x4/t73vleUlWLbi69N9pwTTjihuODgggsu8IsJDASSAVSH4vuNkQA67LlG9z3llFOK+/TtEe973/uOOuqo4mR8ZeOcN2/eZZddFoPrr7++mLLLipslPPDAA7fddlsxpVBse3Gr4x5VvuDgU5/6VJoE/ZdkANUh9lyj/cee6xFHHDFlypRPfvKT0YmPPvroE088MXrzueeem5bbE+64447x48dHapk4cWKszE033RRrGFOilcY6x5S03K4aN25ccQ/miy66aMKm35aMzS+2/ZhjjimuCXj++ec3LdtTyhccdEgn0P9I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" alt=""></p></li> <li><p>每个 chunk 都有至少两个属性：</p> <ul><li>name：默认为 main</li> <li>id：唯一编号，开发环境和 name 相同，生产环境是一个数字，从0 开始</li></ul></li></ul> <h4 id="_2-构建所有依赖模块"><a href="#_2-构建所有依赖模块" class="header-anchor">#</a> 2.构建所有依赖模块</h4> <p><img src="/docs/assets/img/chunks.f31fc40e.png" alt=""></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ./src/index.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./b.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ./src/a.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./b.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token string">'a'</span><span class="token punctuation">;</span>

<span class="token comment">// ./src/b.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li>./src/index.js 出发，dependencies 中保存 <code>['./src/a.js', './src/b.js']</code> , <code>['./src/b.js']</code></li> <li>替换依赖函数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 模块id : ./src/index.js</span>
<span class="token comment">// 转化后的代码</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">'./src/a.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">'./src/b.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 模块id : ./src/a.js</span>
<span class="token comment">// 转化后的代码</span>
<span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">'./b.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token string">'a'</span><span class="token punctuation">;</span>

<span class="token comment">// 模块id : ./src/b.js</span>
<span class="token comment">// 转化后的代码</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li><p>保存生成后的列表</p> <blockquote><p>AST在线测试工具：https://astexplorer.net/</p></blockquote></li> <li><p>简图:</p> <p><img src="/docs/assets/img/chunks2.0cf79306.png" alt=""></p></li></ul> <h4 id="_3-产生chunk-assets"><a href="#_3-产生chunk-assets" class="header-anchor">#</a> 3.产生chunk assets</h4> <ul><li><p>在第二步完成后，chunk 中会产生一个模块列表，列表中包含了模块 id 和模块转换后的代码。</p></li> <li><p>接下来，webpack 会根据配置为 chunk 生成一个资源列表，即 chunk assets，资源列表可以理解为是生成到最终文件的文件名和文件内容。</p> <p><img src="/docs/assets/img/chunk-assets.71b92a8b.png" alt=""></p> <blockquote><p>chunk hash 是根据所有 chunk assets 的内容生成的一个 hash 字符串。  hash：一种算法，具体有很多分类，特点是将一个任意长度的字符串转换为一个固定长度的字符串，而且可以保证原始内容不变，产生的 hash 字符串就不变。</p></blockquote></li> <li><p>简图：</p> <p><img src="/docs/assets/img/chunk-assets2.a2749993.png" alt=""></p></li></ul> <h4 id="_4-合并chunk-assets"><a href="#_4-合并chunk-assets" class="header-anchor">#</a> 4.合并chunk assets</h4> <ul><li><p>将多个 chunk 的 assets 合并到一起，并产生一个总的 hash .</p> <p><img src="/docs/assets/img/chunk-hash.c6f7a04b.png" alt=""></p></li></ul> <h3 id="输出-emit"><a href="#输出-emit" class="header-anchor">#</a> 输出 emit</h3> <p>此步骤非常简单，webpack 将利用 node 中的 fs 模块，根据编译产生的总的 assets ，生成相应的文件。</p> <p><img src="/docs/assets/img/output.ec041911.png" alt=""></p> <h3 id="总过程"><a href="#总过程" class="header-anchor">#</a> 总过程</h3> <p><img src="/docs/assets/img/res1.5944090a.png" alt=""></p> <p><img src="/docs/assets/img/res2.f31fc40e.png" alt=""></p> <h3 id="补充"><a href="#补充" class="header-anchor">#</a> 补充</h3> <ul><li>module：模块，分割的代码单元，webpack 中的模块可以是任何内容的文件，不仅限于 JS</li> <li>chunk：webpack 内部构建模块的块，一个 chunk 中包含多个模块，这些模块是从入口模块通过依赖分析得来的</li> <li>bundle：chunk 构建好模块后会生成 chunk 的资源清单，清单中的每一项就是一个 bundle，可以认为 bundle 就是最终生成的文件</li> <li>chunkhash：chunk 生成的资源清单内容联合生成的 hash 值</li> <li>chunkname：chunk 的名称，如果没有配置则使用 main</li> <li>id：通常指 chunk 的唯一编号，如果在开发环境下构建，和chunkname 相同；如果是生产环境下构建，则使用一个从 0 开始的数字进行编号</li></ul> <h2 id="入口和出口"><a href="#入口和出口" class="header-anchor">#</a> 入口和出口</h2> <ul><li>入口配置的是 chunk</li></ul> <h3 id="output"><a href="#output" class="header-anchor">#</a> output</h3> <ul><li>path 绝对路径，默认是 dist</li> <li>filename 生成文件的规则
<ul><li>[name] chunkname</li> <li>[hash] 生成的总 hash 值</li> <li>[chunkhash:5] chunk 对应的 hash 值</li> <li>[id] 开发环境是 name 生产环境是数字</li></ul></li></ul> <h3 id="最佳实践"><a href="#最佳实践" class="header-anchor">#</a> 最佳实践</h3> <h4 id="一个页面一个-js"><a href="#一个页面一个-js" class="header-anchor">#</a> 一个页面一个 js</h4> <ul><li><p>源码结构：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>src
  <span class="token operator">-</span> pageA
    <span class="token operator">-</span> index<span class="token punctuation">.</span>js
  <span class="token operator">-</span> pageB
    <span class="token operator">-</span> index<span class="token punctuation">.</span>js
  <span class="token operator">-</span> pageC
    <span class="token operator">-</span> main<span class="token punctuation">.</span>js   主功能
    <span class="token operator">-</span> main2<span class="token punctuation">.</span>js  额外功能
  <span class="token operator">-</span> common 公共目录
    <span class="token operator">-</span> <span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>webpack:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    pageA<span class="token operator">:</span> <span class="token string">'./src/pageA/index.js'</span><span class="token punctuation">,</span>
    pageB<span class="token operator">:</span> <span class="token string">'./src/pageB/index.js'</span>
    pageC<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./src/pageC/main.js'</span><span class="token punctuation">,</span> <span class="token string">'./src/pageC/main2.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 配置合并 js 文件的规则</span>
    filename<span class="token operator">:</span> <span class="token string">&quot;[name]-[chunkhash:5].js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li></ul> <p>适用于重复代码较少的情况，只会影响传输请求。那么为什么不能打包一个 common chunk 呢？</p> <ul><li>原因在于打包后的模块是单独的作用域的。而且由于依赖关系，原来的模块打包的代码中也是包含 common 的代码的。</li></ul> <h4 id="一个页面多个-js"><a href="#一个页面多个-js" class="header-anchor">#</a> 一个页面多个 js</h4> <ul><li><p>源码结构：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>src
  <span class="token operator">-</span> pageA
    <span class="token operator">-</span> index<span class="token punctuation">.</span>js
  <span class="token operator">-</span> pageB
    <span class="token operator">-</span> index<span class="token punctuation">.</span>js
  <span class="token operator">-</span> statistics 用于统计访问人数功能
    <span class="token operator">-</span> index<span class="token punctuation">.</span>js
  <span class="token operator">-</span> common 公共目录
    <span class="token operator">-</span> <span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>webpack:</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    pageA<span class="token operator">:</span> <span class="token string">'./src/pageA/index.js'</span><span class="token punctuation">,</span>
    pageB<span class="token operator">:</span> <span class="token string">'./src/pageB/index.js'</span><span class="token punctuation">,</span>
    statistics<span class="token operator">:</span> <span class="token string">'./src/statistics/index.js'</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 配置合并 js 文件的规则</span>
    filename<span class="token operator">:</span> <span class="token string">&quot;[name]-[chunkhash:5].js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul> <p>模块间不依赖，完全独立，就可以单独开一个 chunk 。</p> <h4 id="单页应用"><a href="#单页应用" class="header-anchor">#</a> 单页应用</h4> <ul><li><p>源码结构：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>src
  <span class="token operator">-</span> sunFunc  子功能
    <span class="token operator">-</span> index<span class="token punctuation">.</span>js
  <span class="token operator">-</span> sunFunc  子功能
    <span class="token operator">-</span> index<span class="token punctuation">.</span>js
  <span class="token operator">-</span> common  公共目录
    <span class="token operator">-</span> <span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>webpack:</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    main<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 配置合并 js 文件的规则</span>
    filename<span class="token operator">:</span> <span class="token string">&quot;[name]-[hash:5].js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul> <h2 id="loader"><a href="#loader" class="header-anchor">#</a> loader</h2> <blockquote><p>本质是一个函数，它的作用是将某个源码字符串换成另一个源码字符串返回。</p></blockquote> <p>读取文件内容，分析语法树之前，会处理 loaders 。在打包过程中执行，所以不直接支持 es6 module （需要做特殊的处理）。</p> <ul><li><p>当前模块是否满足 loader 处理条件。</p></li> <li><p>否，生成空数组，直接做语法树分析。是，读取 loaders 数组，
依次处理。</p> <p><img src="/docs/assets/img/loaders.d43fb4cd.png" alt=""></p></li> <li><p>使用插件 loader-utils 来获取传递的参数。</p></li> <li><p>从上往下解析匹配，但是从下往上，从右往左运行！ ！！</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
      rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// 从上往下匹配，但是从下往上运行</span>
          <span class="token punctuation">{</span>
              test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">test-loader\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">//正则表达式，匹配模块的路径</span>
              use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./loaders/test-loader.js?changeVal=未知数&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./loaders/loader1.js&quot;</span><span class="token punctuation">]</span>
                <span class="token comment">// options: {</span>
                <span class="token comment">//     changeVal: &quot;未知数&quot;</span>
                <span class="token comment">// }</span>
               <span class="token comment">//匹配到了之后，使用哪些加载器</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//规则1</span>
          <span class="token punctuation">{</span>
              test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">test-loader\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">//正则表达式，匹配模块的路径</span>
              use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./loaders/loader1.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./loaders/loader2.js&quot;</span><span class="token punctuation">]</span> <span class="token comment">//匹配到了之后，使用哪些加载器</span>
          <span class="token punctuation">}</span> <span class="token comment">//规则2</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//模块的匹配规则</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li></ul> <h3 id="样式、图片处理"><a href="#样式、图片处理" class="header-anchor">#</a> 样式、图片处理</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 自定义的 loaders</span>
<span class="token comment">// 样式处理</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">sourceCode</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    const styleLabel = document.createElement('style');
    styleLabel.innerHTML = \`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sourceCode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\`;
    document.head.appendChild(styleLabel);
    module.exports=\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sourceCode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\`;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 图片处理</span>
<span class="token keyword">var</span> loaderUtil <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;loader-utils&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">loader</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//给的是buffer</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;文件数据大小：(字节)&quot;</span><span class="token punctuation">,</span> buffer<span class="token punctuation">.</span>byteLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token punctuation">{</span> limit <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span> filename <span class="token operator">=</span> <span class="token string">&quot;[contenthash].[ext]&quot;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> loaderUtil<span class="token punctuation">.</span><span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>buffer<span class="token punctuation">.</span>byteLength <span class="token operator">&gt;=</span> limit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> content <span class="token operator">=</span> <span class="token function">getFilePath</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> buffer<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
        content <span class="token operator">=</span> <span class="token string">&quot;../dist/&quot;</span> <span class="token operator">+</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> content <span class="token operator">=</span> <span class="token function">getBase64</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">module.exports = \`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\`</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

loader<span class="token punctuation">.</span>raw <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//该loader要处理的是原始数据</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> loader<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getBase64</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;data:image/png;base64,&quot;</span> <span class="token operator">+</span> buffer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">&quot;base64&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getFilePath</span><span class="token punctuation">(</span><span class="token parameter">buffer<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> filename <span class="token operator">=</span> loaderUtil<span class="token punctuation">.</span><span class="token function">interpolateName</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        content<span class="token operator">:</span> buffer
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emitFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> filename<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// index.js 中的内容</span>
<span class="token comment">// 处理样式</span>
<span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./assets/style.css'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 处理图片</span>
<span class="token keyword">var</span> src <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./assets/webpack.png&quot;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;img&quot;</span><span class="token punctuation">)</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><h2 id="plugin"><a href="#plugin" class="header-anchor">#</a> plugin</h2> <p>loader 做代码转化的，比较局限。复杂功能的实现需要插件。如：</p> <ul><li>当 webpack 生成文件时，顺便多生产一个说明描述文件。</li> <li>当 webpack 编译的时候，控制台输出一句话表示 webpack 启动。</li> <li>当xxxx时，xxxx</li></ul> <p>这种类似的功能需要把功能嵌入到 webpack 的编译流程中，而这种事情的实现是依托于 plugin 的。</p> <p><img src="/docs/assets/img/plugin1.cf3be9c0.png" alt=""></p> <p>plugin的<strong>本质</strong>是一个带有apply方法的对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> plugin <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">apply</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>通常，习惯上，我们会将该对象写成构造函数的模式</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">MyPlugin</span><span class="token punctuation">{</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> plugin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>要将插件应用到webpack，需要把插件对象配置到webpack的plugins数组中，如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">MyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>apply函数会在初始化阶段，创建好Compiler对象后运行。</p> <p>compiler对象是在初始化阶段构建的，整个webpack打包期间只有一个compiler对象，后续完成打包工作的是compiler对象内部创建的compilation</p> <p>apply方法会在<strong>创建好compiler对象后调用</strong>，并向方法传入一个compiler对象</p> <p><img src="/docs/assets/img/plugin2.238d5e6d.png" alt=""></p> <p>compiler对象提供了大量的钩子函数（hooks，可以理解为事件），plugin的开发者可以注册这些钩子函数，参与webpack编译和生成。</p> <p>你可以在apply方法中使用下面的代码注册钩子函数:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">MyPlugin</span><span class="token punctuation">{</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>事件名称<span class="token punctuation">.</span><span class="token function">事件类型</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//事件处理函数</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>事件名称</strong></p> <p>即要监听的事件名，即钩子名，所有的钩子：https://www.webpackjs.com/api/compiler-hooks</p> <p><strong>事件类型</strong></p> <p>这一部分使用的是 Tapable API，这个小型的库是一个专门用于钩子函数监听的库。</p> <p>它提供了一些事件类型：</p> <ul><li>tap：注册一个同步的钩子函数，函数运行完毕则表示事件处理结束</li> <li>tapAsync：注册一个基于回调的异步的钩子函数，函数通过调用一个回调表示事件处理结束</li> <li>tapPromise：注册一个基于 Promise 的异步的钩子函数，函数通过返回的 Promise 进入已决状态表示事件处理结束</li></ul> <p><strong>处理函数</strong></p> <p>处理函数有一个事件参数<code>compilation</code>。</p> <h2 id="配置细节-细枝末节"><a href="#配置细节-细枝末节" class="header-anchor">#</a> 配置细节 - 细枝末节</h2> <ul><li>配置文件如果导出一个函数，则会将返回结果作为配置对象。可以通过命令指定环境,通过一个配置文件配置多个环境。<code>webpack --env='xxx'</code></li> <li>context: 会影响入口和 loader 的路径配置基础。</li> <li><code>output: { library, libraryTarget }</code> 打包结果立即执行函数结果会暴露给 library 规定的 变量。
<ul><li>和插件一起配合得到打包结果。</li> <li>写的不是一个工程，是一个 库，类似于 jquery ，希望别人使用 $ 等全局变量。</li> <li>libraryTarget 更精细控制导出。</li></ul></li> <li><code>target: &quot;web&quot;</code> 打包结果执行的环境，默认是 web 。还可以设置 node 。</li> <li><code>module: { noParse: /jquery/ }</code> 不用解析，例如针对 jquery 等大型的<strong>单模块库</strong>（已经打包过的，没有其他依赖），来提高构建效率，和运行时没有任何关系，呵呵了！</li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code>resolve<span class="token operator">:</span> <span class="token punctuation">{</span>  
  <span class="token comment">// modules 模块的查找位置</span>
  modules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// require(&quot;./a&quot;) webapck 会从 extensions 中补全后缀</span>
  extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.json&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 别名，这个比较高频使用！！</span>
  alias<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;@&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;_&quot;</span><span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 通过 cdn 引入了,遇到哪个包不用管,替换为导出一个 $ _</span>
externals<span class="token operator">:</span> <span class="token punctuation">{</span>
  jquery<span class="token operator">:</span> <span class="token string">&quot;$&quot;</span><span class="token punctuation">,</span>
  lodash<span class="token operator">:</span> <span class="token string">&quot;_&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><code>stats</code> webpack 执行后控制台的输出内容。</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2022年7月9日星期六 18:39</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/docs/frontend/webpack/commonTools.html">
        常用扩展
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/docs/assets/js/app.84b26931.js" defer></script><script src="/docs/assets/js/2.ce1bac44.js" defer></script><script src="/docs/assets/js/3.de591152.js" defer></script><script src="/docs/assets/js/7.f3e6aa45.js" defer></script>
  </body>
</html>
