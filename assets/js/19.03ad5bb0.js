(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{450:function(s,t,a){"use strict";a.r(t);var n=a(33),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"promise"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#promise"}},[s._v("#")]),s._v(" promise")]),s._v(" "),a("h2",{attrs:{id:"事件循环-event-loop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事件循环-event-loop"}},[s._v("#")]),s._v(" 事件循环 event-loop")]),s._v(" "),a("ul",[a("li",[s._v("浏览器宿主环境五个线程：\n"),a("ul",[a("li",[s._v("js 引擎：负责执行执行栈栈顶代码。")]),s._v(" "),a("li",[s._v("GUI 线程：负责页面的渲染。（与 js 引擎相互等待）")]),s._v(" "),a("li",[s._v("事件监听线程：负责监听事件。")]),s._v(" "),a("li",[s._v("计时线程：负责计时。")]),s._v(" "),a("li",[s._v("网络线程：负责网络通信的。")])])])]),s._v(" "),a("p",[s._v("当上面的线程发生了某些事情，会将处理程序加入到事件队列的内存。当 js 引擎发现执行栈没有内容的时候，会将事件队列的第一个函数加入到执行栈执行。js 引擎对从事件队列取出以及与宿主环境之间的配合，称之为事件循环。")]),s._v(" "),a("ul",[a("li",[s._v("事件队列\n"),a("ul",[a("li",[s._v("宏任务：计时器结束的回调、http 回调、事件的回调")]),s._v(" "),a("li",[s._v("微任务: MutationObserver、promise")])])])]),s._v(" "),a("h2",{attrs:{id:"promise-基础"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#promise-基础"}},[s._v("#")]),s._v(" promise 基础")]),s._v(" "),a("ul",[a("li",[s._v("两个阶段三个状态。阶段状态皆不可逆。。。")]),s._v(" "),a("li",[a("code",[s._v("new Promise(() => { 描述任务的逻辑 })")])]),s._v(" "),a("li",[s._v(".then .catch\n"),a("ul",[a("li",[s._v("then 返回一个新的 promise")]),s._v(" "),a("li",[s._v("如果前一个 promise 没有后续处理的函数，则和之前的 promise 任务状态一致，数据也一样。")]),s._v(" "),a("li",[s._v("有后续处理，还没有执行，处于挂起状态。")]),s._v(" "),a("li",[s._v("有后续处理，执行了，若无错，则新任务状态为完成，"),a("em",[s._v("数据为后续处理返回值")]),s._v("，若有错，则失败原因。")])])]),s._v(" "),a("li",[s._v("链式调用（表白的场景，表白失败下一个 ）")]),s._v(" "),a("li",[s._v("静态方法（做家务的场景）\n"),a("ul",[a("li",[s._v("Promise.resolve(data)")]),s._v(" "),a("li",[s._v("Promise.reject(reason)")]),s._v(" "),a("li",[s._v("Promise.all([]) 返回一个新 Promise .所有成功才成功，若失败，则为失败的。")]),s._v(" "),a("li",[s._v("Promise.race([]) 一个已决就可，返回则为第一个。")]),s._v(" "),a("li",[s._v("Promise.any([]) 一个成功就可，返回则为第一个,全失败才失败")]),s._v(" "),a("li",[s._v("Promise.allSettled([]) 返回一个新 Promise .所有有结果才成功，只会出现 pendding fullfilled。")])])])]),s._v(" "),a("h3",{attrs:{id:"练习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#练习"}},[s._v("#")]),s._v(" 练习")]),s._v(" "),a("ul",[a("li",[s._v("延迟一段时间输出 finish")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("duration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" duration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'finish'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"async-await"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#async-await"}},[s._v("#")]),s._v(" async await")]),s._v(" "),a("ul",[a("li",[s._v("promise 没有消除回调，只是统一了异步处理场景以及回调地狱。")]),s._v(" "),a("li",[s._v("语法糖 -> 消除了异步场景的回调。 es7 2016 推出 async await")]),s._v(" "),a("li",[s._v("async 一定返回 promise 返回后续处理的相关数据")]),s._v(" "),a("li",[s._v("失败就会报错，需要 try...catch 来捕获")])])])}),[],!1,null,null,null);t.default=e.exports}}]);